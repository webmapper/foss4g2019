<!doctype html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <title>Building a national tile set</title>

  <link rel="stylesheet" href="css/reset.css">
  <link rel="stylesheet" href="css/reveal.css">
  <link rel="stylesheet" href="css/theme/webmapper.css">

  <!-- Theme used for syntax highlighting of code -->
  <link rel="stylesheet" href="lib/css/monokai.css">
  <style>
    .leaflet-control-container {
      display: none !important;
    }
  </style>
  <!-- Printing and PDF exports -->
  <script>
    var link = document.createElement('link');
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
    document.getElementsByTagName('head')[0].appendChild(link);
  </script>
</head>

<body>
  <div class="reveal">
    <div class="slides">
      <section data-background-iframe="./cartiqo/">
        <h1>Building a national vector tile set</h1>
        <br />
        <h2>by: Steven Ottens - <a href="//twitter.com/stvno" style="font-weight: normal; color: #333333"> @stvno</a>
        </h2>
        <br />
        <h2><a style="font-weight: normal; color: #333333"
            href="https://webmapper.github.io/foss4g2019/">webmapper.github.io/foss4g2019</a></h2>
      </section>
      <section data-background-image="img/webmapperbkg.png" style="color:#eeeeec; text-shadow: 0px 0px 4px #333333">
        <h3 style="color:#eeeeec; text-shadow: 2px 2px 4px #333333">Webmapper</h3>
        <h4 style="color:#eeeeec; text-shadow: 2px 2px 4px #333333 ">Utrecht, the Netherlands</h4>
        <br />
        <br />
        <br />
        <br />
        <p class="fragment fade-up">Data - Design - Technology</p>
      </section>
      <section>
        <section>background</section>
        <section data-transition="fade" data-background-image="img/top50.jpg">
          <h2 style="color:#333333;  margin-top: -25vh;">1:50 000</h2>
        </section>
        <section data-transition="fade" data-background-image="img/top25.jpg">
          <h2 style="color:#333333;  margin-top: -25vh;">1:25 000</h2>
        </section>
        <section data-background-iframe="./brt/" data-background-interactive style="text-align: left">
          <p class="fragment slide">1:1000 0000</p>
          <p class="fragment slide">1:500 0000</p>
          <p class="fragment slide">1:250 0000</p>
          <p class="fragment slide">1:100 0000</p>
          <p class="fragment slide">1:50 0000</p>
          <p class="fragment slide">1:10 0000</p>
          <p class="fragment slide">large scale topography</p>
        </section>
        <section data-background-image="img/data.png">
          <h1 style="color: #eeeeec; text-shadow: 2px 2px 4px #333333; ">Lots of Data</h1>
        </section>


        <section data-background-iframe="https://data.amsterdam.nl/data/?modus=kaart">
          <h1 style="color: #41382f; text-shadow: 2px 2px 4px #eeeeec; opacity:0.9;">Beautiful maps</h1>
        </section>
        <section data-background-iframe="bgt/bgt.map"></section>
      </section>
      <section>
        <section data-background-iframe="./cartiqobeeld/">
          <div style="font-family: 'cartiqo'; font-size: 100px; color: #eeeeec">cartiqo</div>
        </section>
        <section data-background-iframe="./cartiqobeeld/">
          <p style=" font-size: 50px; color: #eeeeec">Consistent</p>
          <p class="fragment slide-up" style=" font-size: 50px; color: #eeeeec">Accurate</p>
          <p class="fragment slide-up" style=" font-size: 50px; color: #eeeeec">Simple</p>
          <p class="fragment slide-up" style=" font-size: 50px; color: #eeeeec">Fast</p>
        </section>
      </section>
      <section>
        <section>
          <h3>Consistent</h3>
          <img class="fragment fade" width="200px" data-src="img/nature5.png" /><img class="fragment fade" width="200px"
            data-src="img/nature11.png" /><img class="fragment fade" width="200px" data-src="img/nature16.png" />
          <p class="fragment fade">across zoom levels</p>
          <p class="fragment fade">across source data</p>
        </section>
        <section data-transition="slide-in fade-out">
          <h3>Create a datamodel</h3>
          <img style="height:50vh" data-src="img/cartiqo_schema.png" /><br />
          <a href="https://github.com/webmapper/cartiqo-documentation">github.com/webmapper/cartiqo-documentation</a>
        </section>
        <section data-transition="fade-in slide-out">
          <h3>Create a datamodel</h3>
          <img style="height:50vh" data-src="img/openzoomstack.png" /><br />
          <a href="https://www.ordnancesurvey.co.uk/business-and-government/products/os-open-zoomstack.html">Open
            Zoomstack - Ordnance Survey</a>
        </section>
        <section>
          <h3>Map your source data</h3>
          <pre><code data-trim data-noescape>
              ----------NATURAL--------------------
              --high
              INSERT INTO cartiqo.natural_5_6_uo (type,  geom, originalId)
              select 'high', st_multi(geometrie_vlak_3857), gml_id
              from top1000.terrein where typelandgebruik = 'bos';

              --bare
              INSERT INTO cartiqo.natural_5_6_uo (type,  geom, originalId)
              select 'bare', st_multi(geometrie_vlak_3857), gml_id
              from top1000.terrein where typelandgebruik = 'zand';
            </code></pre>
          <span class="fragment fade" style="border:solid 2px #317581;border-radius: 4px;padding:10px;"><b>⁂</b> SQL is
            your friend <b>⁂</b></span>
        </section>
      </section>
      <section>
        <section>
          <h3>Accurate</h3>
          <div style="margin-left: -20vw;width: 90vw;"><img class="fragment fade" width="350px"
              data-src="img/accurate1.png" /><img class="fragment fade" width="350px"
              data-src="img/accurate3.png" /><img class="fragment fade" width="350px" data-src="img/accurate4.png" />*
          </div>
          <p class="fragment fade">authorative </p>
          <p class="fragment fade">up to date</p>
          <p class="fragment fade" style="text-align: end;"><a
              style="font-style: italic; color: #317581; font-size: smaller"
              href="https://ogleearth.com/2010/11/about-costa-rica-nicaragua-their-border-and-google/">* ogle earth</a>
          </p>
        </section>
        <section>
          <h3>Paper trail</h3>
          <img class="fragment fade" height="300px" data-src="img/paper1.png" /><img class="fragment fade"
            height="300px" data-src="img/paper2.png" />
          <p class="fragment fade">Include original IDs</p>
          <p class="fragment fade">Document your sources</p>

        </section>
        <section>
          <h3>Automate</h3>
          <img height="250px" data-src="img/automate.gif" />
          <pre class="fragment fade"><code data-trim data-noescape>
            if [ $theirdate -gt $ourdate ]; then
              # there is a newer file on the server, lets run the scripts
              ./run.sh $url $theirs
            else
              echo "No newer version of "$file"; currently at "$theirs
            fi
           </code></pre>
          <span class="fragment fade" style="border:solid 2px #317581;border-radius: 4px;padding:10px;"><b>⁂</b> Bash is
            your friend <b>⁂</b></span>
        </section>
      </section>
      <section>
        <section>
          <h3>Simple</h3>
          <div style="display: flex">
            <div> <img data-src="img/simple.gif" /></div>
            <div style="display: flex;flex-direction: column;justify-content: center; text-align: left ">
              <p class="fragment fade">to use</p>
              <p class="fragment fade">to create</p>
              <p class="fragment fade">to maintain</p>
            </div>
          </div>
        </section>
        <section>
          <h3>Data wrangling</h3>
          <div style="display: flex">
            <div> <img height="250px" data-src="img/datawrangling.gif" /></div>
            <div style="display: flex;flex-direction: column;justify-content: center; text-align: left ">
              <p class="fragment fade">11 different sources</p>
              <p class="fragment fade">different datamodels</p>
              <p class="fragment fade">different update frequencies</p>
            </div>
          </div>
          <span class="fragment fade" style="border:solid 2px #317581;border-radius: 4px;padding:10px;"><b>⁂</b> PostGIS
            is
            your friend <b>⁂</b></span>
          <p class="fragment fade" style="text-decoration: line-through "><a
              href="https://github.com/mapbox/tippecanoe">tippecanoe</a></p>
          <p class="fragment fade" style="text-decoration: line-through "><a
              href="https://openmaptiles.org/osm2vectortiles/">osm2vectortiles</a></p>
        </section>
        <section>
          <h3>Tile management</h3>
          <div style="display: flex">
            <div><img height="450px" data-src="img/updates.gif" /> </div>
            <div style="display: flex;flex-direction: column;justify-content: center; text-align: left ">
              <p class="fragment fade">easy configuration</p>
              <p class="fragment fade">(re)seeding options</p>
              <p class="fragment fade">S3 backend</p>

              <p class="fragment fade" style="text-decoration: line-through "><a
                  href="https://github.com/mapbox/tilelive">tilelive</a></p>
              <p class="fragment fade"><a style="text-decoration: line-through "
                  href="https://docs.geoserver.org/latest/en/user/extensions/vectortiles/tutorial.html">geoserver</a>
                <a style="text-decoration: line-through " href="https://t-rex.tileserver.ch/">t-rex</a></p>
            </div>
          </div>
          <span class="fragment fade" style="border:solid 2px #317581;border-radius: 4px;padding:10px;"><b>⁂</b> Tegola
            is your friend <b>⁂</b></span>
        </section>
      </section>
      <section>
        <section>
          <h3>Fast</h3>
          <div style="display: flex">
            <div><img height="450px" data-src="img/fast.gif" /> </div>
            <div style="display: flex;flex-direction: column;justify-content: center; text-align: left ">
              <p class="fragment fade">to create</p>
              <p class="fragment fade">to deliver</p>
              <p class="fragment fade">to render</p>
            </div>
          </div>
        </section>
        <section>
          <h3>Order your data</h3>
          <pre class="fragment fade"><code data-trim data-noescape>
                  CREATE TABLE cartiqo.natural_5_6 AS
                    SELECT * FROM cartiqo.natural_5_6_uo
                      ORDER BY ST_GeoHash(ST_Transform(ST_Envelope(geom),4326),10)
                      COLLATE "C";

                  CREATE INDEX cartiqo_natural_5_6_geohash
                    ON cartiqo.natural_5_6
                    (ST_GeoHash(ST_Transform(ST_Envelope(geom),4326),10));

                  CLUSTER cartiqo.natural_5_6 USING cartiqo_natural_5_6_geohash;

                  CREATE INDEX cartiqo_natural_5_6_geom
                      ON cartiqo.natural_5_6 USING gist (geom);
                 </code></pre>
          <span class="fragment fade" style="border:solid 2px #317581;border-radius: 4px;padding:10px;"><b>⁂</b> <A
              href="http://www.paulnorman.ca/blog/2016/05/improve-your-st-geohash-sorting-with-these-three-simple-tricks/">Paul
              Norman</A> is your friend <b>⁂</b></span>
        </section>
        <section>
          <h3>Enable web speed</h3>
          <p class="fragment fade">gzip encoding</p>
          <p class="fragment fade">cache-headers</p>
          <p class="fragment fade">multiple subdomains</p>
          <span class="fragment fade" style="border:solid 2px #317581;border-radius: 4px;padding:10px;"><b>⁂</b> CDN is your friend <b>⁂</b></span>
          <div ><img height="250px" class="fade fragment" data-src="img/headers.png"/><img class="fade fragment" height="250px" data-src="img/timing.png"/></div>
        </section>

      </section>

      <section data-transition="fade-out">
        <h3>Pop quiz:</h3>
        <p class="fragment slide">Feature type: "barren terrain"</p>
        <p class="fragment slide">Physical appearance: "open pavement"</p>
        <p style="opacity:0">Hardening formed by related elements of <b>limited</b> dimensions, such as, for example,
          clinkers and tiles.
      </section>
      <section data-transition="fade" data-background-image="img/straat.jpeg">
        <h3>Pop quiz:</h3>
        <p style="color:#eeeeec; text-shadow: 2px 2px 4px #333333">Feature type: "barren terrain"</p>
        <p style="color:#eeeeec; text-shadow: 2px 2px 4px #333333">Physical appearance: "open pavement"</p>
        <p class="fragment slide" style="color:#eeeeec; text-shadow: 2px 2px 4px #333333; font-style: italic">
          Hardening formed by
          related elements of <b>limited</b> dimensions, such as, for example, clinkers and tiles.
      </section>
    </div>
  </div>

  <script src="js/reveal.js"></script>

  <script>
    // More info about config & dependencies:
    // - https://github.com/hakimel/reveal.js#configuration
    // - https://github.com/hakimel/reveal.js#dependencies
    Reveal.initialize({
      history: true,
      dependencies: [{
          src: 'plugin/markdown/marked.js'
        },
        {
          src: 'plugin/markdown/markdown.js'
        },
        {
          src: 'plugin/notes/notes.js',
          async: true
        },
        {
          src: 'plugin/highlight/highlight.js',
          async: true
        }
      ]
    });
  </script>
</body>

</html>